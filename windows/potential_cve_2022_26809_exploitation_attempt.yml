- dataTypes:
  - wineventlog
  name: Potential CVE-2022-26809 Exploitation Attempt
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: T1190, T1569.002
  adversary: UNKNOWN
  description: Detects suspicious remote procedure call (RPC) service anomalies based
    on the spawned sub processes (long shot to detect the exploitation of vulnerabilities
    like CVE-2022-26809)
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26809
  - https://www.bleepingcomputer.com/startups/RpcSs.exe-14544.html
  - https://twitter.com/cyb3rops/status/1514217991034097664
  - https://www.securonix.com/blog/cve-2022-26809-remote-procedure-call-runtime-remote-code-execution-vulnerability-and-coverage/
  where: safe("log.parentImage", "") == "C:\\Windows\\System32\\svchost.exe" && safe("log.parentCommandLine",
    "").contains("-k RPCSS")
