- dataTypes:
  - wineventlog
  name: CVE-2023-40477 Potential Exploitation - .REV File Creation
  impact:
    confidentiality: 1
    integrity: 1
    availability: 2
  category: Execution
  technique: Unknown
  adversary: UNKNOWN
  description: Detects the creation of ".rev" files by WinRAR. Could be indicative
    of potential exploitation of CVE-2023-40477. Look for a suspicious execution shortly
    after creation or a WinRAR application crash.
  references:
  - https://wildptr.io/winrar-cve-2023-40477-poc-new-vulnerability-winrar-security-research/
  - https://github.com/wildptr-io/Winrar-CVE-2023-40477-POC
  - https://www.rarlab.com/vuln_rev3_names.html
  where: (safe("log.image", "").endsWith("\\explorer.exe") || safe("log.image", "").endsWith("\\WinRAR.exe"))
    && safe("log.targetFileName", "").endsWith(".rev")
