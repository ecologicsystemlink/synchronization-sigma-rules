- dataTypes:
  - wineventlog
  name: File Creation Date Changed to Another Year
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1070.006
  adversary: UNKNOWN
  description: Attackers may change the file creation time of a backdoor to make it
    look like it was installed with the operating system. Note that many processes
    legitimately change the creation time of a file; it does not necessarily indicate
    malicious activity.
  references:
  - https://www.inversecos.com/2022/04/defence-evasion-technique-timestomping.html
  where: (safe("log.previousCreationUtcTime", "").startsWith("2022") && !(safe("log.creationUtcTime",
    "").startsWith("2022")) || safe("log.previousCreationUtcTime", "").startsWith("202")
    && !(safe("log.creationUtcTime", "").startsWith("202"))) && !(safe("log.image",
    "") == "C:\\Windows\\system32\\ProvTool.exe" || safe("log.image", "") == "C:\\Windows\\System32\\usocoreworker.exe"
    || safe("log.image", "") == "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"
    || safe("log.targetFileName", "").startsWith("C:\\ProgramData\\USOPrivate\\UpdateStore\\")
    || safe("log.targetFileName", "").endsWith(".tmp") || safe("log.targetFileName",
    "").endsWith(".temp") || safe("log.image", "").startsWith("C:\\WINDOWS\\") &&
    safe("log.image", "").endsWith("\\TiWorker.exe") && safe("log.targetFileName",
    "").endsWith(".cab"))
