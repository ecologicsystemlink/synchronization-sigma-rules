- dataTypes:
  - wineventlog
  name: Potential SharePoint ToolShell CVE-2025-53770 Exploitation - File Create
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects the creation of file such as spinstall0.aspx which may indicate
    successful exploitation of CVE-2025-53770. CVE-2025-53770 is a zero-day vulnerability
    in SharePoint that allows remote code execution.
  references:
  - https://research.eye.security/sharepoint-under-siege/
  - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
  - https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/
  where: (safe("log.targetFileName", "").startsWith("C:\\Program Files\\Common Files\\Microsoft
    Shared\\Web Server Extensions\\") || safe("log.targetFileName", "").startsWith("C:\\Program
    Files (x86)\\Common Files\\Microsoft Shared\\Web Server Extensions\\")) && (safe("log.targetFileName",
    "").contains("\\15\\TEMPLATE\\LAYOUTS\\") || safe("log.targetFileName", "").contains("\\16\\TEMPLATE\\LAYOUTS\\"))
    && (safe("log.targetFileName", "").endsWith("\\spinstall.aspx") || safe("log.targetFileName",
    "").matches(".*\\\\spinstall.\\.aspx") || safe("log.targetFileName", "").endsWith("\\debug_dev.js"))
