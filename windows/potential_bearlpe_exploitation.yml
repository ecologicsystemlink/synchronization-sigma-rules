- dataTypes:
  - wineventlog
  name: Potential BearLPE Exploitation
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1053.005
  adversary: UNKNOWN
  description: Detects potential exploitation of the BearLPE exploit using Task Scheduler
    ".job" import arbitrary DACL write\par
  references:
  - https://github.com/djhohnstein/polarbearrepo/blob/f26d3e008093cc5c835e92a7165170baf6713d43/bearlpe/polarbear/polarbear/exploit.cpp
  where: (safe("log.image", "").endsWith("\\schtasks.exe") || safe("log.originalFileName",
    "") == "schtasks.exe") && safe("log.commandLine", "").contains("/change") && safe("log.commandLine",
    "").contains("/TN") && safe("log.commandLine", "").contains("/RU") && safe("log.commandLine",
    "").contains("/RP")
