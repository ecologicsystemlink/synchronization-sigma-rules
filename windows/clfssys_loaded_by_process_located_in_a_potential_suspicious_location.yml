- dataTypes:
  - wineventlog
  name: Clfs.SYS Loaded By Process Located In a Potential Suspicious Location
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Execution
  technique: T1059
  adversary: UNKNOWN
  description: Detects Clfs.sys being loaded by a process running from a potentially
    suspicious location. Clfs.sys is loaded as part of many CVEs exploits that targets
    Common Log File.
  references:
  - https://ssd-disclosure.com/ssd-advisory-common-log-file-system-clfs-driver-pe/
  - https://x.com/Threatlabz/status/1879956781360976155
  where: safe("log.imageLoaded", "").endsWith("\\clfs.sys") && (safe("log.image",
    "").contains(":\\Perflogs\\") || safe("log.image", "").contains(":\\Users\\Public\\")
    || safe("log.image", "").contains("\\Temporary Internet") || safe("log.image",
    "").contains("\\Windows\\Temp\\") || safe("log.image", "").contains(":\\Users\\")
    && safe("log.image", "").contains("\\Favorites\\") || safe("log.image", "").contains(":\\Users\\")
    && safe("log.image", "").contains("\\Favourites\\") || safe("log.image", "").contains(":\\Users\\")
    && safe("log.image", "").contains("\\Contacts\\") || safe("log.image", "").contains(":\\Users\\")
    && safe("log.image", "").contains("\\Pictures\\"))
