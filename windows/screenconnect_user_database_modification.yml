- dataTypes:
  - wineventlog
  name: ScreenConnect User Database Modification
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Persistence
  technique: Unknown
  adversary: UNKNOWN
  description: Detects file modifications to the temporary xml user database file
    indicating local user modification in the ScreenConnect server. This will occur
    during exploitation of the ScreenConnect Authentication Bypass vulnerability (CVE-2024-1709)
    in versions <23.9.8, but may also be observed when making legitimate modifications
    to local users or permissions.
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  where: safe("log.targetFileName", "").endsWith(".xml") && safe("log.targetFileName",
    "").contains("Temp") && safe("log.targetFileName", "").contains("ScreenConnect")
    && safe("log.image", "").endsWith("\\ScreenConnect.Service.exe")
