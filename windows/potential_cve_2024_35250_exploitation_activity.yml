- dataTypes:
  - wineventlog
  name: Potential CVE-2024-35250 Exploitation Activity
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Security Detection
  technique: T1068
  adversary: UNKNOWN
  description: Detects potentially suspicious loading of "ksproxy.ax", which may indicate
    an attempt to exploit CVE-2024-35250.
  references:
  - https://thehackernews.com/2024/12/cisa-and-fbi-raise-alerts-on-exploited.html
  - https://github.com/varwara/CVE-2024-35250
  - https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/
  - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  where: safe("log.imageLoaded", "").endsWith("\\ksproxy.ax") && !(safe("log.image",
    "").startsWith("C:\\Program Files\\") || safe("log.image", "").startsWith("C:\\Program
    Files (x86)\\") || safe("log.image", "").startsWith("C:\\Windows\\System32\\")
    || safe("log.image", "").startsWith("C:\\Windows\\SysWOW64\\")) && !(safe("log.image",
    "").endsWith("\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe") || safe("log.image",
    "").endsWith("\\AppData\\Roaming\\Zoom\\bin\\Zoom.exe") || safe("log.image", "").endsWith("\\AppData\\Local\\Mozilla
    Firefox\\firefox.exe") || safe("log.image", "").endsWith("\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe")
    || safe("log.image", "").endsWith("\\AppData\\Local\\Programs\\Opera\\opera.exe")
    || safe("log.image", "").matches(".*\\\\AppData\\\\Local\\\\Discord\\\\app-.*\\\\Discord\\.exe"))
