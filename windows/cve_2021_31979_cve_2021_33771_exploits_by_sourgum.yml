- dataTypes:
  - wineventlog
  name: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1566, T1203
  adversary: UNKNOWN
  description: Detects patterns as noticed in exploitation of Windows CVE-2021-31979
    CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum
  references:
  - https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/
  - https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/
  where: safe("log.targetFileName", "").contains("C:\\Windows\\system32\\physmem.sys")
    || safe("log.targetFileName", "").contains("C:\\Windows\\System32\\IME\\IMEJP\\imjpueact.dll")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\ime\\IMETC\\IMTCPROT.DLL")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\ime\\SHARED\\imecpmeid.dll")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\config\\spp\\ServiceState\\Recovery\\pac.dat")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\config\\cy-GB\\Setup\\SKB\\InputMethod\\TupTask.dat")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\config\\config\\startwus.dat")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\ime\\SHARED\\WimBootConfigurations.ini")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\ime\\IMEJP\\WimBootConfigurations.ini")
    || safe("log.targetFileName", "").contains("C:\\Windows\\system32\\ime\\IMETC\\WimBootConfigurations.ini")
