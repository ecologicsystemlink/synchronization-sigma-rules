- dataTypes:
  - wineventlog
  name: Potential Pikabot C2 Activity
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1573
  adversary: UNKNOWN
  description: Detects the execution of rundll32 that leads to an external network
    connection. The malware Pikabot has been seen to use this technique to initiate
    C2-communication through hard-coded Windows binaries.
  references:
  - https://www.virustotal.com/gui/file/d72af640b71b8e3eca3eba660dd7c7f029ff8852bcacaa379e7b6c57cf4d9b44
  - https://www.virustotal.com/gui/file/6bb4cdbaef03b732a93559a58173e7f16b29bfb159a1065fae9185000ff23b4b
  - https://github.com/pr0xylife/Pikabot/blob/7f7723a74ca325ec54c6e61e076acce9a4b20538/Pikabot_06.12.2023.txt
  where: safe("log.parentImage", "").endsWith("\\rundll32.exe") && (safe("log.image",
    "").endsWith("\\SearchFilterHost.exe") || safe("log.image", "").endsWith("\\SearchProtocolHost.exe")
    || safe("log.image", "").endsWith("\\sndvol.exe") || safe("log.image", "").endsWith("\\wermgr.exe")
    || safe("log.image", "").endsWith("\\wwahost.exe")) && safe("protocol", "") ==
    "tcp" && safe("log.initiated", "") == "true"
