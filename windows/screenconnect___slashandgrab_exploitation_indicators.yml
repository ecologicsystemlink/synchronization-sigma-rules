- dataTypes:
  - wineventlog
  name: ScreenConnect - SlashAndGrab Exploitation Indicators
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: General Security
  technique: Unknown
  adversary: UNKNOWN
  description: Detects indicators of exploitation by threat actors during exploitation
    of the "SlashAndGrab" vulnerability related to ScreenConnect as reported Team
    Huntress
  references:
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  where: safe("log.targetFileName", "").contains("C:\\Windows\\Temp\\ScreenConnect\\")
    && safe("log.targetFileName", "").contains("\\LB3.exe") || safe("log.targetFileName",
    "").contains("C:\\mpyutd.msi") || safe("log.targetFileName", "").contains("C:\\perflogs\\RunSchedulerTaskOnce.ps1")
    || safe("log.targetFileName", "").contains("C:\\ProgramData\\1.msi") || safe("log.targetFileName",
    "").contains("C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\mpyutd.msi")
    || safe("log.targetFileName", "").contains("C:\\ProgramData\\update.dat") || safe("log.targetFileName",
    "").contains("C:\\Users\\oldadmin\\Documents\\MilsoftConnect\\Files\\ta.exe")
    || safe("log.targetFileName", "").contains("C:\\Windows\\Help\\Help\\SentinelAgentCore.dll")
    || safe("log.targetFileName", "").contains("C:\\Windows\\Help\\Help\\SentinelUI.exe")
    || safe("log.targetFileName", "").contains("C:\\Windows\\spsrv.exe") || safe("log.targetFileName",
    "").contains("C:\\Windows\\Temp\\svchost.exe")
