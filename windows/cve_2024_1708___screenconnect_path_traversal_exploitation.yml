- dataTypes:
  - wineventlog
  name: CVE-2024-1708 - ScreenConnect Path Traversal Exploitation
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Persistence
  technique: Unknown
  adversary: UNKNOWN
  description: This detects file modifications to ASPX and ASHX files within the root
    of the App_Extensions directory, which is allowed by a ZipSlip vulnerability in
    versions prior to 23.9.8. This occurs during exploitation of CVE-2024-1708.
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  where: safe("log.image", "").endsWith("\\ScreenConnect.Service.exe") && (safe("log.targetFileName",
    "").matches(".*ScreenConnect\\\\App_Extensions\\\\.*\\.ashx") || safe("log.targetFileName",
    "").matches(".*ScreenConnect\\\\App_Extensions\\\\.*\\.aspx")) && !(safe("log.targetFileName",
    "").matches(".*ScreenConnect\\\\App_Extensions\\\\.*\\\\.*"))
