- dataTypes:
  - wineventlog
  name: Malware Shellcode in Verclsid Target Process
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1055
  adversary: UNKNOWN
  description: Detects a process access to verclsid.exe that injects shellcode from
    a Microsoft Office application / VBA macro
  references:
  - https://twitter.com/JohnLaTwC/status/837743453039534080
  where: safe("log.targetImage", "").endsWith("\\verclsid.exe") && safe("log.grantedAccess",
    "") == "0x1FFFFF" && (safe("log.callTrace", "").contains("|UNKNOWN(") && safe("log.callTrace",
    "").contains("VBE7.DLL") || safe("log.sourceImage", "").contains("\\Microsoft
    Office\\") && safe("log.callTrace", "").contains("|UNKNOWN"))
