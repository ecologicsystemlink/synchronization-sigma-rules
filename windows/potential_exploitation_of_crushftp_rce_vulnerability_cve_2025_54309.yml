- dataTypes:
  - wineventlog
  name: Potential Exploitation of CrushFTP RCE Vulnerability (CVE-2025-54309)
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: T1059.001, T1059.003, T1068, T1190
  adversary: UNKNOWN
  description: Detects suspicious child processes created by CrushFTP. It could be
    an indication of exploitation of a RCE vulnerability such as CVE-2025-54309.
  references:
  - https://reliaquest.com/blog/threat-spotlight-cve-2025-54309-crushftp-exploit/
  - https://pwn.guide/free/web/crushftp
  - https://firecompass.com/crushftp-vulnerability-cve-2025-54309-securing-file-transfer-services/
  where: safe("log.parentImage", "").endsWith("\\crushftp.exe") && ((safe("log.image",
    "").endsWith("\\powershell.exe") || safe("log.image", "").endsWith("\\powershell_ise.exe")
    || safe("log.image", "").endsWith("\\pwsh.exe")) && safe("log.commandLine", "").contains("IEX")
    && safe("log.commandLine", "").contains("enc") && safe("log.commandLine", "").contains("Hidden")
    && safe("log.commandLine", "").contains("bypass") || safe("log.image", "").endsWith("\\cmd.exe")
    && (safe("log.commandLine", "").contains("/c powershell") || safe("log.commandLine",
    "").contains("whoami") || safe("log.commandLine", "").contains("net.exe") || safe("log.commandLine",
    "").contains("net1.exe")) || safe("log.image", "").endsWith("\\bitsadmin.exe")
    || safe("log.image", "").endsWith("\\certutil.exe") || safe("log.image", "").endsWith("\\mshta.exe")
    || safe("log.image", "").endsWith("\\cscript.exe") || safe("log.image", "").endsWith("\\wscript.exe"))
