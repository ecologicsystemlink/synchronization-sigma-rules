- dataTypes:
  - wineventlog
  name: Windows Update Error
  impact:
    confidentiality: 1
    integrity: 1
    availability: 1
  category: Impact
  technique: T1584
  adversary: UNKNOWN
  description: Detects Windows update errors including installation failures and connection
    issues. Defenders should observe this in case critical update KBs aren't installed.
  references:
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/f1b010ce0ee1b71e3024180de1a3e67f99701fe4/ETWProvidersManifests/Windows10/1903/W10_1903_Pro_20200714_18362.959/WEPExplorer/Microsoft-Windows-WindowsUpdateClient.xml
  where: safe("log.providerName", "") == "Microsoft-Windows-WindowsUpdateClient" &&
    (safe("log.eventCode", 0.0) == double(16) || safe("log.eventCode", 0.0) == double(20)
    || safe("log.eventCode", 0.0) == double(24) || safe("log.eventCode", 0.0) == double(213)
    || safe("log.eventCode", 0.0) == double(217))
