- dataTypes:
  - wineventlog
  name: Potential Notepad++ CVE-2025-49144 Exploitation
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1574.008
  adversary: UNKNOWN
  description: Detects potential exploitation of CVE-2025-49144, a local privilege
    escalation vulnerability in Notepad++ installers (v8.8.1 and prior) where the
    installer calls regsvr32.exe without specifying the full path. This allows an
    attacker to execute arbitrary code with elevated privileges by placing a malicious
    regsvr32.exe alongside this Legitimate Notepad++ installer. The vulnerability
    is triggered when the installer attempts to register the NppShell.dll file, which
    is a component of Notepad++.
  references:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-49144
  - https://x.com/NullSecurityX/status/1937444064867029179
  where: safe("log.image", "").endsWith("\\regsvr32.exe") && safe("log.commandLine",
    "").startsWith("regsvr32 /s") && safe("log.commandLine", "").contains("\\contextMenu\\NppShell.dll")
    && !(safe("log.image", "") == "C:\\Windows\\System32\\regsvr32.exe" || safe("log.image",
    "") == "C:\\Windows\\SysWOW64\\regsvr32.exe")
