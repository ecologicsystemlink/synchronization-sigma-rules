- dataTypes:
  - wineventlog
  name: Potential Process Hollowing Activity
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Security Detection
  technique: T1055.012
  adversary: UNKNOWN
  description: Detects when a memory process image does not match the disk image,
    indicative of process hollowing.
  references:
  - https://twitter.com/SecurePeacock/status/1486054048390332423?s=20
  - https://www.bleepingcomputer.com/news/microsoft/microsoft-sysmon-now-detects-malware-process-tampering-attempts/
  where: safe("log.type", "") == "Image is replaced" && !(safe("log.image", "").contains(":\\Program
    Files (x86)") || safe("log.image", "").contains(":\\Program Files\\") || safe("log.image",
    "").contains(":\\Windows\\System32\\wbem\\WMIADAP.exe") || safe("log.image", "").contains(":\\Windows\\SysWOW64\\wbem\\WMIADAP.exe"))
    && !(safe("log.image", "").contains("\\AppData\\Local\\Programs\\Opera\\") &&
    safe("log.image", "").endsWith("\\opera.exe") || safe("log.image", "").endsWith("\\WindowsApps\\MicrosoftEdge.exe"))
