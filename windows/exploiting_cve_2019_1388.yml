- dataTypes:
  - wineventlog
  name: Exploiting CVE-2019-1388
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1068
  adversary: UNKNOWN
  description: Detects an exploitation attempt in which the UAC consent dialogue is
    used to invoke an Internet Explorer process running as LOCAL_SYSTEM
  references:
  - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388
  - https://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege
  where: safe("log.parentImage", "").endsWith("\\consent.exe") && safe("log.image",
    "").endsWith("\\iexplore.exe") && safe("log.commandLine", "").contains(" http")
    && (safe("log.integrityLevel", "") == "System" || safe("log.integrityLevel", "")
    == "S-1-16-16384" || safe("log.user", "").contains("AUTHORI") || safe("log.user",
    "").contains("AUTORI"))
