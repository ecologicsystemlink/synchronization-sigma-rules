- dataTypes:
  - wineventlog
  name: Potential MOVEit Transfer CVE-2023-34362 Exploitation - File Activity
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects file indicators of potential exploitation of MOVEit CVE-2023-34362.
  references:
  - https://www.bleepingcomputer.com/news/security/new-moveit-transfer-zero-day-mass-exploited-in-data-theft-attacks/
  - https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023
  - https://www.rapid7.com/blog/post/2023/06/01/rapid7-observed-exploitation-of-critical-moveit-transfer-vulnerability/
  - https://www.reddit.com/r/sysadmin/comments/13wxuej/comment/jmhdg55/
  where: (safe("log.targetFileName", "").contains("\\MOVEit Transfer\\wwwroot\\")
    || safe("log.targetFileName", "").contains("\\MOVEitTransfer\\wwwroot\\")) &&
    (safe("log.targetFileName", "").endsWith(".7z") || safe("log.targetFileName",
    "").endsWith(".bat") || safe("log.targetFileName", "").endsWith(".dll") || safe("log.targetFileName",
    "").endsWith(".exe") || safe("log.targetFileName", "").endsWith(".ps1") || safe("log.targetFileName",
    "").endsWith(".rar") || safe("log.targetFileName", "").endsWith(".vbe") || safe("log.targetFileName",
    "").endsWith(".vbs") || safe("log.targetFileName", "").endsWith(".zip")) || safe("log.targetFileName",
    "").endsWith("\\MOVEit Transfer\\wwwroot\\_human2.aspx.lnk") || safe("log.targetFileName",
    "").endsWith("\\MOVEit Transfer\\wwwroot\\_human2.aspx") || safe("log.targetFileName",
    "").endsWith("\\MOVEit Transfer\\wwwroot\\human2.aspx.lnk") || safe("log.targetFileName",
    "").endsWith("\\MOVEit Transfer\\wwwroot\\human2.aspx") || safe("log.targetFileName",
    "").endsWith("\\MOVEitTransfer\\wwwroot\\_human2.aspx.lnk") || safe("log.targetFileName",
    "").endsWith("\\MOVEitTransfer\\wwwroot\\_human2.aspx") || safe("log.targetFileName",
    "").endsWith("\\MOVEitTransfer\\wwwroot\\human2.aspx.lnk") || safe("log.targetFileName",
    "").endsWith("\\MOVEitTransfer\\wwwroot\\human2.aspx") || (safe("log.creationUtcTime",
    "").startsWith("2023-03- ") || safe("log.creationUtcTime", "").startsWith("2023-04-
    ") || safe("log.creationUtcTime", "").startsWith("2023-05- ") || safe("log.creationUtcTime",
    "").startsWith("2023-06- ")) && safe("log.targetFileName", "").contains("\\Windows\\Microsoft.net\\Framework64\\v")
    && safe("log.targetFileName", "").contains("\\Temporary ASP.NET Files\\") && safe("log.targetFileName",
    "").contains("App_Web_") && safe("log.targetFileName", "").endsWith(".dll")
