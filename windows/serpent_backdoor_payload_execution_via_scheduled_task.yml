- dataTypes:
  - wineventlog
  name: Serpent Backdoor Payload Execution Via Scheduled Task
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: T1053.005, T1059.006
  adversary: UNKNOWN
  description: Detects post exploitation execution technique of the Serpent backdoor.
    According to Proofpoint, one of the commands that the backdoor ran was via creating
    a temporary scheduled task using an unusual method. It creates a fictitious windows
    event and a trigger in which once the event is created, it executes the payload.
  references:
  - https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain
  where: (safe("log.image", "").endsWith("\\cmd.exe") || safe("log.image", "").endsWith("\\powershell.exe"))
    && safe("log.commandLine", "").contains("[System/EventID=") && safe("log.commandLine",
    "").contains("/create") && safe("log.commandLine", "").contains("/delete") &&
    safe("log.commandLine", "").contains("/ec") && safe("log.commandLine", "").contains("/so")
    && safe("log.commandLine", "").contains("/tn run")
