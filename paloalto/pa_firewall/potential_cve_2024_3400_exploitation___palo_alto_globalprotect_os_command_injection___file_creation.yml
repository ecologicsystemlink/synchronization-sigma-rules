- dataTypes:
  - firewall-paloalto
  name: Potential CVE-2024-3400 Exploitation - Palo Alto GlobalProtect OS Command
    Injection - File Creation
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Execution
  technique: Unknown
  adversary: UNKNOWN
  description: Detects suspicious file creations in the Palo Alto Networks PAN-OS'
    parent telemetry folder, which are processed by the vulnerable 'dt_curl' script
    if device telemetry is enabled. As said script overrides the shell-subprocess
    restriction, arbitrary command execution may occur by carefully crafting filenames
    that are escaped through this function.
  references:
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-3400
  where: (safe("log.targetFileName", "").contains("{IFS}") || safe("log.targetFileName",
    "").contains("base64") || safe("log.targetFileName", "").contains("bash") || safe("log.targetFileName",
    "").contains("curl") || safe("log.targetFileName", "").contains("http")) && safe("log.targetFileName",
    "").startsWith("/opt/panlogs/tmp/device_telemetry/")
