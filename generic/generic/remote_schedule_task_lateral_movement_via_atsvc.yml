- dataTypes:
  - generic
  name: Remote Schedule Task Lateral Movement via ATSvc
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: T1053, T1053.002
  adversary: UNKNOWN
  description: Detects remote RPC calls to create or execute a scheduled task via
    ATSvc
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  where: safe("log.eventLog", "") == "RPCFW" && safe("log.eventCode", 0.0) == double(3)
    && safe("log.interfaceUuid", "") == "1ff70682-0a51-30e8-076d-740be8cee98b" &&
    (safe("log.opNum", "") == 0 || safe("log.opNum", "") == 1)
