- dataTypes:
  - generic
  name: Grafana Path Traversal Exploitation CVE-2021-43798
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects a successful Grafana path traversal exploitation
  references:
  - https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix/
  - https://github.com/search?q=CVE-2021-43798
  where: safe("log.csUriQuery", "").contains("/../../../../../../../") && safe("log.scStatus",
    "") == 200 && (safe("log.csUriQuery", "").contains("/public/plugins/live") ||
    safe("log.csUriQuery", "").contains("/public/plugins/icon") || safe("log.csUriQuery",
    "").contains("/public/plugins/loki") || safe("log.csUriQuery", "").contains("/public/plugins/text")
    || safe("log.csUriQuery", "").contains("/public/plugins/logs") || safe("log.csUriQuery",
    "").contains("/public/plugins/news") || safe("log.csUriQuery", "").contains("/public/plugins/stat")
    || safe("log.csUriQuery", "").contains("/public/plugins/mssql") || safe("log.csUriQuery",
    "").contains("/public/plugins/mixed") || safe("log.csUriQuery", "").contains("/public/plugins/mysql")
    || safe("log.csUriQuery", "").contains("/public/plugins/tempo") || safe("log.csUriQuery",
    "").contains("/public/plugins/graph") || safe("log.csUriQuery", "").contains("/public/plugins/gauge")
    || safe("log.csUriQuery", "").contains("/public/plugins/table") || safe("log.csUriQuery",
    "").contains("/public/plugins/debug") || safe("log.csUriQuery", "").contains("/public/plugins/zipkin")
    || safe("log.csUriQuery", "").contains("/public/plugins/jaeger") || safe("log.csUriQuery",
    "").contains("/public/plugins/geomap") || safe("log.csUriQuery", "").contains("/public/plugins/canvas")
    || safe("log.csUriQuery", "").contains("/public/plugins/grafana") || safe("log.csUriQuery",
    "").contains("/public/plugins/welcome") || safe("log.csUriQuery", "").contains("/public/plugins/xychart")
    || safe("log.csUriQuery", "").contains("/public/plugins/heatmap") || safe("log.csUriQuery",
    "").contains("/public/plugins/postgres") || safe("log.csUriQuery", "").contains("/public/plugins/testdata")
    || safe("log.csUriQuery", "").contains("/public/plugins/opentsdb") || safe("log.csUriQuery",
    "").contains("/public/plugins/influxdb") || safe("log.csUriQuery", "").contains("/public/plugins/barchart")
    || safe("log.csUriQuery", "").contains("/public/plugins/annolist") || safe("log.csUriQuery",
    "").contains("/public/plugins/bargauge") || safe("log.csUriQuery", "").contains("/public/plugins/graphite")
    || safe("log.csUriQuery", "").contains("/public/plugins/dashlist") || safe("log.csUriQuery",
    "").contains("/public/plugins/piechart") || safe("log.csUriQuery", "").contains("/public/plugins/dashboard")
    || safe("log.csUriQuery", "").contains("/public/plugins/nodeGraph") || safe("log.csUriQuery",
    "").contains("/public/plugins/alertlist") || safe("log.csUriQuery", "").contains("/public/plugins/histogram")
    || safe("log.csUriQuery", "").contains("/public/plugins/table-old") || safe("log.csUriQuery",
    "").contains("/public/plugins/pluginlist") || safe("log.csUriQuery", "").contains("/public/plugins/timeseries")
    || safe("log.csUriQuery", "").contains("/public/plugins/cloudwatch") || safe("log.csUriQuery",
    "").contains("/public/plugins/prometheus") || safe("log.csUriQuery", "").contains("/public/plugins/stackdriver")
    || safe("log.csUriQuery", "").contains("/public/plugins/alertGroups") || safe("log.csUriQuery",
    "").contains("/public/plugins/alertmanager") || safe("log.csUriQuery", "").contains("/public/plugins/elasticsearch")
    || safe("log.csUriQuery", "").contains("/public/plugins/gettingstarted") || safe("log.csUriQuery",
    "").contains("/public/plugins/state-timeline") || safe("log.csUriQuery", "").contains("/public/plugins/status-history")
    || safe("log.csUriQuery", "").contains("/public/plugins/grafana-clock-panel")
    || safe("log.csUriQuery", "").contains("/public/plugins/grafana-simple-json-datasource")
    || safe("log.csUriQuery", "").contains("/public/plugins/grafana-azure-monitor-datasource"))
