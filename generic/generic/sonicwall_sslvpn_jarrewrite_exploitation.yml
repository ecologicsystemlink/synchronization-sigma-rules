- dataTypes:
  - generic
  name: SonicWall SSL/VPN Jarrewrite Exploitation
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects exploitation attempts of the SonicWall Jarrewrite Exploit
  references:
  - https://web.archive.org/web/20210126045316/https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/
  - https://github.com/darrenmartyn/VisualDoor
  where: safe("log.csUriQuery", "").contains("/cgi-bin/jarrewrite.sh") && (safe("log.csUserAgent",
    "").contains(":;") || safe("log.csUserAgent", "").contains("() {") || safe("log.csUserAgent",
    "").contains("/bin/bash -c"))
