- dataTypes:
  - generic
  name: CVE-2023-1389 Potential Exploitation Attempt - Unauthenticated Command Injection
    In TP-Link Archer AX21
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects potential exploitation attempt of CVE-2023-1389 an Unauthenticated
    Command Injection in TP-Link Archer AX21.
  references:
  - https://www.tenable.com/security/research/tra-2023-11
  - https://github.com/Voyag3r-Security/CVE-2023-1389/blob/4ecada7335b17bf543c0e33b2c9fb6b6215c09ae/archer-rev-shell.py
  - https://www.zerodayinitiative.com/blog/2023/4/21/tp-link-wan-side-vulnerability-cve-2023-1389-added-to-the-mirai-botnet-arsenal
  where: (safe("log.csMethod", "") == "GET" || safe("log.csMethod", "") == "POST")
    && safe("log.csUri", "").contains("/cgi-bin/luci/;stok=/locale") && safe("log.csUri",
    "").contains("form=country") && (""safe("log.operation", "")=safe("log.write",
    "")"" || ""safe("log.country", "")=$("")
