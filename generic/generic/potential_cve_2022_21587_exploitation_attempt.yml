- dataTypes:
  - generic
  name: Potential CVE-2022-21587 Exploitation Attempt
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects potential exploitation attempts of CVE-2022-21587 an arbitrary
    file upload vulnerability impacting Oracle E-Business Suite (EBS). CVE-2022-21587
    can lead to unauthenticated remote code execution.
  references:
  - https://www.rapid7.com/blog/post/2023/02/07/etr-cve-2022-21587-rapid7-observed-exploitation-of-oracle-e-business-suite-vulnerability/
  - https://attackerkb.com/topics/Bkij5kK1qK/cve-2022-21587/rapid7-analysis
  - https://github.com/hieuminhnv/CVE-2022-21587-POC
  - https://blog.viettelcybersecurity.com/cve-2022-21587-oracle-e-business-suite-unauth-rce/
  where: safe("log.csMethod", "") == "POST" && (safe("log.csUriQuery", "").matches(".*/OA_HTML/BneViewerXMLService.bne:uueupload=TRUE.*")
    || safe("log.csUriQuery", "").matches(".*/OA_HTML/BneUploaderService.bne:uueupload=TRUE.*")
    || safe("log.csUriQuery", "").matches(".*/OA_HTML/BneDownloadService.bne:uueupload=TRUE.*")
    || safe("log.csUriQuery", "").matches(".*/OA_HTML/BneOfflineLOVService.bne:uueupload=TRUE.*"))
