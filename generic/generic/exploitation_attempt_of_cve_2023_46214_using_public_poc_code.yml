- dataTypes:
  - generic
  name: Exploitation Attempt Of CVE-2023-46214 Using Public POC Code
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1210
  adversary: UNKNOWN
  description: Detects exploitation attempt of CVE-2023-46214, a remote code execution
    (RCE) in Splunk Enterprise through insecure XML parsing using known public proof
    of concept code
  references:
  - https://github.com/nathan31337/Splunk-RCE-poc/
  - https://blog.hrncirik.net/cve-2023-46214-analysis
  - https://advisory.splunk.com/advisories/SVD-2023-1104
  where: safe("log.csMethod", "") == "POST" && (safe("log.scStatus", "") == 200 ||
    safe("log.scStatus", "") == 302) && (safe("log.csUriStem", "").contains("/splunkd/__upload/indexing/preview")
    && safe("log.csUriQuery", "").contains("NO_BINARY_CHECK=1") && safe("log.csUriQuery",
    "").contains("input.path=shell.xsl") || safe("log.csUriStem", "").contains("/api/search/jobs")
    && safe("log.csUriStem", "").contains("/results") && safe("log.csUriQuery", "").contains("/opt/splunk/var/run/splunk/dispatch/")
    && safe("log.csUriQuery", "").contains("/shell.xsl"))
