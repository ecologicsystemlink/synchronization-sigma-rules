- dataTypes:
  - generic
  name: Potential Exploitation of CVE-2025-4427/4428 Ivanti EPMM Pre-Auth RCE
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: T1190, T1203
  adversary: UNKNOWN
  description: Detects potential exploitation of a chained vulnerability attack targeting
    Ivanti EPMM 12.5.0.0. CVE-2025-4427 allows unauthenticated access to protected
    API endpoints via an authentication bypass, which can then be leveraged to trigger
    CVE-2025-4428 â€” a remote code execution vulnerability through template injection.
    This sequence enables unauthenticated remote code execution, significantly increasing
    the impact of exploitation.
  references:
  - https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/?123
  where: safe("log.csUriStem", "").contains("/mifs/rs/api/v2/featureusage") && safe("log.csUriQuery",
    "").contains("format=") && (safe("log.csUriQuery", "").contains("java.lang.Runtime")
    && safe("log.csUriQuery", "").contains(".getMethod") && safe("log.csUriQuery",
    "").contains("getRuntime") && safe("log.csUriQuery", "").contains(".exec(") &&
    safe("log.csUriQuery", "").contains(".text") || safe("log.csUriQuery", "").contains("java%2elang%2eRuntime")
    && safe("log.csUriQuery", "").contains("%2egetMethod") && safe("log.csUriQuery",
    "").contains("%2eexec%28") || safe("log.csUriQuery", "").contains("%6a%61%76%61%2e%6c%61%6e%67%2e%52%75%6e%74%69%6d%65%65%28%29")
    || safe("log.csUriQuery", "").contains("%67%65%74%52%75%6e%74%69%6d%65") || safe("log.csUriQuery",
    "").contains("%2e%65%78%65%63%28") || safe("log.csUriQuery", "").matches(".*\\{7.*7\\}.*")
    || safe("log.csUriQuery", "").matches(".*%7B7.*7%7D.*") || safe("log.csUriQuery",
    "").contains("%7b7%2a7%7d"))
