- dataTypes:
  - generic
  name: Rejetto HTTP File Server RCE
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190, T1505.003
  adversary: UNKNOWN
  description: Detects attempts to exploit a Rejetto HTTP File Server (HFS) via CVE-2014-6287
  references:
  - https://vk9-sec.com/hfs-code-execution-cve-2014-6287/
  - https://www.exploit-db.com/exploits/39161
  - https://github.com/Twigonometry/Cybersecurity-Notes/blob/c875b0f52df7d2c7a870e75e1f0c2679d417931d/Writeups/Hack%20the%20Box/Boxes/Optimum/10%20-%20Website.md
  where: safe("log.csUriQuery", "").matches(".*.search=%00\\{\\..*") && (safe("log.csUriQuery",
    "").contains("save|") || safe("log.csUriQuery", "").contains("powershell") ||
    safe("log.csUriQuery", "").contains("cmd.exe") || safe("log.csUriQuery", "").contains("cmd
    /c") || safe("log.csUriQuery", "").contains("cmd /r") || safe("log.csUriQuery",
    "").contains("cmd /k") || safe("log.csUriQuery", "").contains("cscript") || safe("log.csUriQuery",
    "").contains("wscript") || safe("log.csUriQuery", "").contains("python") || safe("log.csUriQuery",
    "").contains("C:\\Users\\Public\\") || safe("log.csUriQuery", "").contains("%comspec%"))
