- dataTypes:
  - generic
  name: Potential Centos Web Panel Exploitation Attempt - CVE-2022-44877
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects potential exploitation attempts that target the Centos Web
    Panel 7 Unauthenticated Remote Code Execution CVE-2022-44877
  references:
  - https://seclists.org/fulldisclosure/2023/Jan/1
  - https://www.rapid7.com/blog/post/2023/01/19/etr-exploitation-of-control-web-panel-cve-2022-44877/
  where: safe("log.csMethod", "") == "POST" && safe("log.csUriQuery", "").contains("/login/index.php")
    && safe("log.csUriQuery", "").contains("login=") && (safe("log.csUriQuery", "").contains("login=$(")
    || safe("log.csUriQuery", "").contains("base64") || safe("log.csUriQuery", "").contains("subprocess")
    || safe("log.csUriQuery", "").contains("socket") || safe("log.csUriQuery", "").contains("${IFS}")
    || safe("log.csUriQuery", "").contains("cHl0aG9u") || safe("log.csUriQuery", "").contains("B5dGhvb")
    || safe("log.csUriQuery", "").contains("weXRob2"))
