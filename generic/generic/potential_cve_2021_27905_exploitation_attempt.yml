- dataTypes:
  - generic
  name: Potential CVE-2021-27905 Exploitation Attempt
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects exploitation attempt of the CVE-2021-27905 which affects all
    Apache Solr versions prior to and including 8.8.1.
  references:
  - https://twitter.com/Al1ex4/status/1382981479727128580
  - https://twitter.com/sec715/status/1373472323538362371
  - https://nsfocusglobal.com/apache-solr-arbitrary-file-read-and-ssrf-vulnerability-threat-alert/
  - https://mp.weixin.qq.com/s?__biz=Mzg3NDU2MTg0Ng==&mid=2247484117&idx=1&sn=2fdab8cbe4b873f8dd8abb35d935d186
  - https://github.com/murataydemir/CVE-2021-27905
  where: safe("log.csUriQuery", "").contains("/solr/") && safe("log.csUriQuery", "").matches(".*/debug/dump..*")
    && safe("log.csUriQuery", "").contains("param=ContentStream") && safe("log.scStatus",
    "") == 200 || safe("log.csMethod", "") == "GET" && safe("log.csUriQuery", "").contains("/solr/")
    && safe("log.csUriQuery", "").contains("command=fetchindex") && safe("log.csUriQuery",
    "").contains("masterUrl=") && safe("log.scStatus", "") == 200
