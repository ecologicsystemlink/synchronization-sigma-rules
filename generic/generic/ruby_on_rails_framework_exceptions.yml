- dataTypes:
  - generic
  name: Ruby on Rails Framework Exceptions
  impact:
    confidentiality: 2
    integrity: 2
    availability: 2
  category: Security Detection
  technique: T1190
  adversary: UNKNOWN
  description: Detects suspicious Ruby on Rails exceptions that could indicate exploitation
    attempts
  references:
  - http://edgeguides.rubyonrails.org/security.html
  - http://guides.rubyonrails.org/action_controller_overview.html
  - https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception
  - https://github.com/rails/rails/blob/cd08e6bcc4cd8948fe01e0be1ea0c7ca60373a25/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb
  where: '""safe("log.actionController", "")::safe("log.invalidAuthenticityToken",
    "")"" || ""safe("log.actionController", "")::safe("log.invalidCrossOriginRequest",
    "")"" || ""safe("log.actionController", "")::safe("log.methodNotAllowed", "")""
    || ""safe("log.actionController", "")::safe("log.badRequest", "")"" || ""safe("log.actionController",
    "")::safe("log.parameterMissing", "")""'
