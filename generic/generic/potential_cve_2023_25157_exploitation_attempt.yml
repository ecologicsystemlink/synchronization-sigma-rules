- dataTypes:
  - generic
  name: Potential CVE-2023-25157 Exploitation Attempt
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: General Security
  technique: Unknown
  adversary: UNKNOWN
  description: Detects a potential exploitation attempt of CVE-2023-25157 a SQL injection
    in GeoServer
  references:
  - https://github.com/win3zz/CVE-2023-25157
  - https://twitter.com/parzel2/status/1665726454489915395
  - https://github.com/advisories/GHSA-7g5f-wrx8-5ccf
  where: safe("log.csMethod", "") == "GET" && safe("log.csUriQuery", "").contains("/geoserver/ows")
    && safe("log.csUriQuery", "").contains("CQL_FILTER=") && (safe("log.csUriQuery",
    "").contains("PropertyIsLike") || safe("log.csUriQuery", "").contains("strEndsWith")
    || safe("log.csUriQuery", "").contains("strStartsWith") || safe("log.csUriQuery",
    "").contains("FeatureId") || safe("log.csUriQuery", "").contains("jsonArrayContains")
    || safe("log.csUriQuery", "").contains("DWithin")) && (safe("log.csUriQuery",
    "").contains("+--") || safe("log.csUriQuery", "").contains("+AS+") || safe("log.csUriQuery",
    "").contains("+OR+") || safe("log.csUriQuery", "").contains("FROM") || safe("log.csUriQuery",
    "").contains("ORDER+BY") || safe("log.csUriQuery", "").contains("SELECT") || safe("log.csUriQuery",
    "").contains("sleep%28") || safe("log.csUriQuery", "").contains("substring%28")
    || safe("log.csUriQuery", "").contains("UNION") || safe("log.csUriQuery", "").contains("WHERE"))
