la sigma-cli me genera a esto
TargetFilename matches "(?i)/lib/python3\\.([5-9]|[0-9]{2})/site-packages/" and lower(TargetFilename) endsWith lower(".pth")

y en el estandar utmstack debe quedar como
safe("log.targetFileName", "").matches("(?i)/lib/python3\\.([5-9]|[0-9]{2})/site-packages/") && safe("log.targetFileName", "").endsWith(".pth")



la sigma-cli me genera a esto
lower(Operation) == lower("UserLoggedIn") and lower(ApplicationId) == lower("9ba1a5c7-f17a-4de9-a1f1-6178c8d51223") and lower(ResultStatus) == lower("Success") and lower(RequestType) == lower("Cmsi:Cmsi") and not (lower(ObjectId) == lower("0000000a-0000-0000-c000-000000000000"))

y en el estandar utmstack debe quedar como
safe("log.operation", "") == "UserLoggedIn" && safe("log.applicationId", "") == "9ba1a5c7-f17a-4de9-a1f1-6178c8d51223" && safe("resultStatus", "") == "Success" && safe("log.requestType", "") == "Cmsi:Cmsi" && safe("log.objectId", "") != "0000000a-0000-0000-c000-000000000000"



la sigma-cli me genera a esto
lower(Operation) contains lower("UpdateInboxRules") and (lower(OperationProperties) contains lower("Forward") or lower(OperationProperties) contains lower("Recipients")) or lower(Operation) contains lower("Set-Mailbox") and (lower(Parameters) contains lower("ForwardingSmtpAddress") or lower(Parameters) contains lower("ForwardingAddress")) or (lower(Operation) contains lower("New-InboxRule") or lower(Operation) contains lower("Set-InboxRule")) and (lower(Parameters) contains lower("ForwardAsAttachmentTo") or lower(Parameters) contains lower("ForwardingAddress") or lower(Parameters) contains lower("ForwardingSmtpAddress") or lower(Parameters) contains lower("ForwardTo") or lower(Parameters) contains lower("RedirectTo") or lower(Parameters) contains lower("RedirectToRecipients"))

y en el estandar utmstack debe quedar como
safe("log.operation", "").contains("UpdateInboxRules") && (safe("log.operationProperties", "").contains("Forward") || safe("log.operationProperties", "").contains("Recipients")) || sae("operation", "").contains("Set-Mailbox") && (safe("log.parameters", "").contains("ForwardingSmtpAddress") || safe("log.parameters", "").contains("ForwardingAddress")) || (safe("log.operation", "").contains("New-InboxRule") || safe("log.operation", "").contains("Set-InboxRule")) && (safe("log.parameters", "").contains("ForwardAsAttachmentTo") || safe("log.parameters", "").contains("ForwardingAddress") || safe("log.parameters", "").contains("ForwardingSmtpAddress") || safe("log.parameters", "").contains("ForwardTo") || safe("log.parameters", "").contains("RedirectTo") || safe("log.parameters", "").contains("RedirectToRecipients"))



la sigma-cli me genera a esto
lower(debugContext?.debugData?.requestUri) contains lower("/reports/password-health/")

y en el estandar utmstack debe quedar como
safe("log.debugContextDebugDataRequestUri", "").contains("/reports/password-health/")



la sigma-cli me genera a esto
lower(Operation) contains lower("domain") and (lower(Operation) contains lower("add") or lower(Operation) contains lower("new"))

y en el estandar utmstack debe quedar como
safe("log.operation", "").contains("domain") && (safe("log.operation", "").contains("add") || safe("log.operation", "").contains("new"))



la sigma-cli me genera a esto
(lower(Image) endsWith lower("\\schtasks.exe") or lower(OriginalFileName) == lower("schtasks.exe")) and lower(CommandLine) contains lower("/change") and lower(CommandLine) contains lower("/TN") and lower(CommandLine) contains lower("/RU") and lower(CommandLine) contains lower("/RP")

y en el estandar utmstack debe quedar como
(safe("log.image", "").endsWith("\\schtasks.exe") || safe("log.originalFileName", "") == "schtasks.exe") && safe("log.commandLine", "").contains("/change") && safe("log.commandLine", "").contains("/TN") && safe("log.commandLine", "").contains("/RU") && safe("log.commandLine", "").contains("/RP")



la sigma-cli me genera a esto
lower(ParentCommandLine) contains lower("\\cmd.exe") and lower(ParentCommandLine) contains lower("/c") and lower(ParentCommandLine) endsWith lower("SetupComplete.cmd") and not (lower(Image) startsWith lower("C:\\Windows\\System32\\") or lower(Image) startsWith lower("C:\\Windows\\SysWOW64\\"))

y en el estandar utmstack debe quedar como
safe("log.parentCommandLine", "").contains("\\cmd.exe") && safe("log.parentCommandLine", "").contains("/c") && safe("log.parentCommandLine", "").endsWith("SetupComplete.cmd") && !(safe("log.image", "").startsWith("C:\\Windows\\System32\\") || safe("log.image", "").startsWith("C:\\Windows\\SysWOW64\\"))



la sigma-cli me genera a esto
lower(Provider_Name) == lower("ESENT") and EventID == 325 and lower(Data) contains lower("ntds.dit") and lower(Data) contains lower(":\\ntds.dit")

y en el estandar utmstack debe quedar como
safe("log.providerName", "") == "ESENT" && safe("log.eventCode", 0.0) == double(325) && safe("log.data", "").contains("ntds.dit") && safe("log.data", "").contains(":\\ntds.dit")