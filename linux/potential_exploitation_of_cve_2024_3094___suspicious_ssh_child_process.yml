- dataTypes:
  - linux
  name: Potential Exploitation of CVE-2024-3094 - Suspicious SSH Child Process
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: Unknown
  adversary: UNKNOWN
  description: Detects potentially suspicious child process of SSH process (sshd)
    with a specific execution user. This could be a sign of potential exploitation
    of CVE-2024-3094.
  references:
  - https://github.com/amlweems/xzbot?tab=readme-ov-file#backdoor-demo
  where: safe("log.parentImage", "").endsWith("/sshd") && (safe("log.commandLine",
    "").startsWith("bash -c") || safe("log.commandLine", "").startsWith("sh -c"))
    && safe("log.user", "") == "root"
