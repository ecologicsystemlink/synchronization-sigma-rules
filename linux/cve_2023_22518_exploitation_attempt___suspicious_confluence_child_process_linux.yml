- dataTypes:
  - linux
  name: CVE-2023-22518 Exploitation Attempt - Suspicious Confluence Child Process
    (Linux)
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Execution
  technique: T1059, T1190
  adversary: UNKNOWN
  description: Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center
    / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g.
    create admin accounts and execute arbitrary commands.
  references:
  - https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html
  - https://www.huntress.com/blog/confluence-to-cerber-exploitation-of-cve-2023-22518-for-ransomware-deployment
  - https://github.com/ForceFledgling/CVE-2023-22518
  where: safe("log.parentImage", "").endsWith("/java") && safe("log.parentCommandLine",
    "").contains("confluence") && (safe("log.image", "").endsWith("/bash") || safe("log.image",
    "").endsWith("/curl") || safe("log.image", "").endsWith("/echo") || safe("log.image",
    "").endsWith("/wget")) && !(safe("log.commandLine", "").contains("ulimit -u"))
